# simple-rpc-framework


## 前言

目前只实现了 RPC 框架最基本的功能

## 介绍

是一款基于 Netty+Kyro+Zookeeper 实现的 RPC 框架。


### 该RPC项目的结构

该框架使用示意图如下图所示：

![](./images/rpc-architure.png)

服务提供端 Server 向注册中心注册服务，服务消费者 Client 通过注册中心拿到服务相关信息，然后再通过网络请求服务提供端 Server。


![](./images/rpc-architure-detail.png)


### 项目基本情况

- 使用Netty实现网络传输；
- 使用开源的序列化机制 Kyro替代 JDK 自带的序列化机制
- 使用 Zookeeper 作为注册中心管理相关服务地址信息
- 动态代理使用JDk自带的动态代理屏蔽远程方法调用的细节
- 客户端调用远程服务的时候进行负载均衡为避免单个服务器响应同一请求，避免造成服务器宕机、崩溃等问题
- Netty 重用 Channel 避免重复连接服务端
- 使用Netty 心跳机制 : 保证客户端和服务端的连接不被断掉，避免重连。
- 集成 Spring 通过注解注册服务和服务消费
- 客户端与服务端通信协议 ，可以将原有的 `RpcRequest`和 `RpcReuqest` 对象作为消息体，然后增加如下字段
  - **魔数** ： 通常是 4 个字节。这个魔数主要是为了筛选来到服务端的数据包，有了这个魔数之后，服务端首先取出前面四个字节进行比对，能够在第一时间识别出这个数据包并非是遵循自定义协议的，也就是无效数据包，为了安全考虑可以直接关闭连接以节省资源。
  - **序列化器编号** ：标识序列化的方式，比如是使用 Java 自带的序列化，还是 json，kyro 等序列化方式。
  - **消息体长度** ： 运行时计算出来。



